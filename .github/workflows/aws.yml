name: Deploy to Amazon ECS

on:
  pull_request:
    branches: [ "master" ]


permissions:
  contents: read

jobs:
  build:
    name: Publish and Deploy
    runs-on: windows-latest
    environment: production

    steps:
    - name: Checkout
      uses: actions/checkout@v3

    - name: Setup .NET SDK
      uses: actions/setup-dotnet@v3
      with:
        dotnet-version: '7.0.401'  # replace with your .NET version
    - name: Install dependencies
      run: dotnet restore
    - name: Build
      run: dotnet build --configuration Release --no-restore
    - name: Publish and to Amazon EC2
      uses: ChristopheLav/iis-deploy@v1
      with:
            website-name: 'SWD-Laundry-Project'
            msdeploy-service-url: ${{ secrets.MSDEPLOY_URL }}
            msdeploy-username: ${{ secrets.MSDEPLOY_USERNAME }}
            msdeploy-password: ${{ secrets.MSDEPLOY_PASSWORD }}
            source-path: 'src/WebUI'


